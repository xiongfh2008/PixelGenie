# 🚀 PixelGenie 启动指南

## ⚡ 快速启动（推荐）

### 方法一：一键启动（最简单）

1. **双击** 项目根目录的 `快速启动.bat` 文件
2. 等待两个窗口打开（前端 + 后端）
3. 浏览器会自动打开 http://localhost:5173

✅ **完成！** 现在可以使用 PixelGenie 了

---

## 🔧 手动启动

如果自动启动脚本不工作，请按以下步骤手动启动：

### 步骤 1：启动后端服务器

**打开第一个命令提示符（CMD）窗口：**

```cmd
cd /d D:\AIProject\PixelGenie\server
node index.js
```

**预期输出：**
```
🚀 Server running on http://localhost:3001
📡 API Health Check: http://localhost:3001/api/health
✅ Available API providers: google, cloudflare, xunfei
```

如果看到这些信息，说明后端启动成功！

### 步骤 2：启动前端服务器

**打开第二个命令提示符（CMD）窗口：**

```cmd
cd /d D:\AIProject\PixelGenie
npm run dev
```

**预期输出：**
```
VITE v5.x.x  ready in xxx ms
➜  Local:   http://localhost:5173/
```

### 步骤 3：访问应用

打开浏览器访问：**http://localhost:5173**

---

## ❌ 常见问题解决

### 问题 1：后端服务器立即退出，没有任何输出

**原因：**
- 可能是 `.env` 文件缺失或配置错误
- 依赖未正确安装

**解决方法：**

1. **检查 .env 文件是否存在：**
   ```cmd
   cd /d D:\AIProject\PixelGenie\server
   dir .env
   ```

2. **如果不存在，创建 `.env` 文件：**
   ```
   GOOGLE_API_KEY=你的Google API密钥
   CLOUDFLARE_API_TOKEN=你的Cloudflare令牌
   CLOUDFLARE_ACCOUNT_ID=你的Cloudflare账号ID
   XUNFEI_API_KEY=你的讯飞API密钥
   XUNFEI_APP_ID=你的讯飞APP ID
   XUNFEI_API_SECRET=你的讯飞API密钥
   ```

3. **重新安装依赖：**
   ```cmd
   cd /d D:\AIProject\PixelGenie
   npm install
   ```

4. **使用调试模式启动：**
   双击 `启动服务器-调试模式.bat` 查看详细错误信息

### 问题 2：端口被占用

**错误信息：**
```
Error: listen EADDRINUSE: address already in use :::3001
```

**解决方法：**

1. **查找占用端口的进程：**
   ```cmd
   netstat -ano | findstr :3001
   ```

2. **结束进程（替换 `<PID>` 为实际进程 ID）：**
   ```cmd
   taskkill /PID <PID> /F
   ```

### 问题 3：前端无法连接后端

**症状：**
- 前端页面显示正常
- 但功能报错："无法连接到服务器"

**解决方法：**

1. **确认后端正在运行：**
   访问 http://localhost:3001/api/health
   
   应该看到 JSON 响应：
   ```json
   {
     "status": "healthy",
     "timestamp": "...",
     "apis": { ... }
   }
   ```

2. **如果无法访问，说明后端未运行，请重新启动后端**

3. **检查防火墙设置：**
   确保防火墙没有阻止 3001 和 5173 端口

### 问题 4：PowerShell 中没有输出

**原因：**
PowerShell 可能抑制了输出

**解决方法：**
使用 CMD（命令提示符）而不是 PowerShell：

1. 按 `Win + R`
2. 输入 `cmd` 并回车
3. 在 CMD 中运行启动命令

---

## 📋 启动检查清单

### 启动前确认：

- [ ] Node.js 已安装（v18+）
  ```cmd
  node --version
  ```

- [ ] 依赖已安装
  ```cmd
  cd D:\AIProject\PixelGenie
  npm install
  ```

- [ ] `.env` 文件已配置
  ```cmd
  cd D:\AIProject\PixelGenie\server
  type .env
  ```

- [ ] 端口 3001 和 5173 未被占用
  ```cmd
  netstat -ano | findstr ":3001 :5173"
  ```

### 启动后验证：

- [ ] 后端窗口显示 "Server running on http://localhost:3001"
- [ ] 前端窗口显示 "Local: http://localhost:5173/"
- [ ] 访问 http://localhost:3001/api/health 返回 JSON
- [ ] 访问 http://localhost:5173 显示界面
- [ ] 上传图片功能正常

---

## 🎯 快速命令参考

### 启动命令

```bash
# 后端（CMD 窗口 1）
cd /d D:\AIProject\PixelGenie\server
node index.js

# 前端（CMD 窗口 2）
cd /d D:\AIProject\PixelGenie
npm run dev
```

### 检查命令

```bash
# 检查 Node.js 版本
node --version

# 检查端口占用
netstat -ano | findstr :3001
netstat -ano | findstr :5173

# 检查后端健康（在浏览器中访问）
http://localhost:3001/api/health
```

### 维护命令

```bash
# 重新安装依赖
cd /d D:\AIProject\PixelGenie
rmdir /s /q node_modules
del package-lock.json
npm install

# 清理缓存
npm cache clean --force
```

---

## 🌐 访问地址

| 服务 | 地址 | 说明 |
|------|------|------|
| 🎨 前端界面 | http://localhost:5173 | 主界面 |
| 🔧 后端 API | http://localhost:3001 | API 服务器 |
| 💚 健康检查 | http://localhost:3001/api/health | 状态检查 |
| 🔍 连接测试 | http://localhost:5173/server-check.html | 服务器状态检查页面 |

---

## 💡 推荐启动方式

### 开发调试时：
使用 **手动分步启动**，可以：
- ✅ 看到详细的启动日志
- ✅ 实时查看错误信息
- ✅ 方便调试和排查问题

### 日常使用时：
使用 **快速启动.bat**，可以：
- ✅ 一键启动所有服务
- ✅ 自动打开独立窗口
- ✅ 方便管理和关闭

---

## 🆘 仍然无法启动？

如果尝试了所有方法仍然无法启动，请：

1. **运行调试脚本：**
   双击 `启动服务器-调试模式.bat`

2. **检查错误信息：**
   查看调试窗口中的详细错误信息

3. **提供以下信息以获取帮助：**
   - Node.js 版本：`node --version`
   - npm 版本：`npm --version`
   - 完整的错误信息（截图或复制）
   - 端口占用情况：`netstat -ano | findstr ":3001 :5173"`

---

## ✅ 成功启动的标志

### 后端窗口：
```
🚀 Server running on http://localhost:3001
📡 API Health Check: http://localhost:3001/api/health
✅ Available API providers: google, cloudflare, xunfei
🔑 Active provider: google
```

### 前端窗口：
```
VITE v5.x.x  ready in xxx ms
➜  Local:   http://localhost:5173/
```

### 浏览器：
- ✅ 访问 http://localhost:5173 看到界面
- ✅ 可以上传图片
- ✅ 功能按钮可点击

---

**现在开始使用 PixelGenie！** 🎉

